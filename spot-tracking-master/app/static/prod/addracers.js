define(["lodash","utils"],function(e,n){"use strict";function t(){n.getObjects("/location").then(o.parseResponse,n.logger),r.__poll=setInterval(o.poll,3e5),window.__DEBUG_RACERS__={internal:r,api:o}}var o,r;return r={markers:[],cleanMarkers:function(n){e.forEach(r.markers,function(e){e.setMap(null)}),r.markers=n}},o={parseResponse:function(t){var o,s,a,i,l,p=[],c=e.groupBy(t.competitors,function(e){return e.spotId});for(a in c){if(c.hasOwnProperty(a))for(l=null,o=0,s=c[a].length;s>o;o+=1)i=c[a][o],n.fixDates(i),n.addLatLon(i),(null===l||i.timestamp>l.timestamp)&&(l=i);n.createRacerPoint(l),p.push(l.marker)}r.cleanMarkers(p),window.competitors=c,r.compStore=c},poll:function(){n.logger("polling","info"),n.getObjects("/location").then(o.parseResponse,n.logger)}},{init:t}});
//# sourceMappingURL=addracers.js
//# sourceMappingURL=addracers.js.map