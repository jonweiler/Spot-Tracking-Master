{"version":3,"file":"app.js","sources":["lib/require-async.js","mapsetup.js","smarker.js","utils.js","addracers.js","addevents.js","sidebar.js"],"names":["define","injectScript","src","s","t","document","createElement","type","async","getElementsByTagName","parentNode","insertBefore","formatUrl","name","id","paramRegex","url","replace","param","test","DEFAULT_PARAM_NAME","indexOf","uid","_uid","load","req","onLoad","config","isBuild","window","toUrl","gmaps","mapOptions","center","lat","lng","mapTypeId","MapTypeId","TERRAIN","zoom","Map","getElementById","inherits","childCtor","parentCtor","tempCtor","prototype","superClass_","constructor","StyledMarker","StyledIcon","StyledIconTypes","bu_","gm_","gp_","Point","ge_","event","gmi_","MarkerImage","styledMarkerOptions","Marker","call","this","me","ci","styleIcon","bindTo","setOptions","styledIconType","styledIconOptions","styleClass","gs_","image_","simage_","addDomListenerOnce","w","width","h","height","set","sw_","getShadowURL","getShadowAnchor","simage","i_","getURL","getAnchor","s_","getShape","k","a_","as_","v","push","CLASS","defaults","setValues","changed","get","length","MVCObject","MARKER","text","color","fore","starcolor","props","_url","starcolor_","text_","color_","fore_","substr","_iconmap","coord","i","Math","round","BUBBLE","google","maps","$","_","map","sm","utils","templates","ev","data","templateSettings","variable","racerInfoBox","template","join","eventInfoBox","getObjects","getJSON","fixDates","obj","timestamp","Date","logger","msg","_type","console","addLatLon","latLng","LatLng","latitude","longitude","createRacerPoint","si","nickname","marker","position","title","infowindow","InfoWindow","content","addListener","open","createEventPoint","drawTrack","track","Polyline","path","o","geodesic","strokeColor","strokeOpacity","strokeWeight","setMap","init","then","api","parseResponse","internal","__poll","setInterval","poll","__DEBUG_RACERS__","markers","cleanMarkers","xs","forEach","l","key","inObj","newest","comp","groupBy","competitors","spotId","hasOwnProperty","compStore","__DEBUG_EVENTS__","race_points","obstacles","React","render","CompetitorList","source","cache","sideUl","compCb","resp","isMounted","setState","Competitor","createClass","displayName","mixins","addons","PureRenderMixin","className","style","href","bio","getInitialState","componentDidMount","bind","rows","state","requirejs","baseUrl","paths","jquery","react","lodash","require","r","e"],"mappings":"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","sourcesContent":["/** @license\n * RequireJS plugin for async dependency load like JSONP and Google Maps\n * Author: Miller Medeiros\n * Version: 0.1.2 (2014/02/24)\n * Released under the MIT license\n */\ndefine('async',[],function(){\n\n    var DEFAULT_PARAM_NAME = 'callback',\n        _uid = 0;\n\n    function injectScript(src){\n        var s, t;\n        s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = src;\n        t = document.getElementsByTagName('script')[0]; t.parentNode.insertBefore(s,t);\n    }\n\n    function formatUrl(name, id){\n        var paramRegex = /!(.+)/,\n            url = name.replace(paramRegex, ''),\n            param = (paramRegex.test(name))? name.replace(/.+!/, '') : DEFAULT_PARAM_NAME;\n        url += (url.indexOf('?') < 0)? '?' : '&';\n        return url + param +'='+ id;\n    }\n\n    function uid() {\n        _uid += 1;\n        return '__async_req_'+ _uid +'__';\n    }\n\n    return{\n        load : function(name, req, onLoad, config){\n            if(config.isBuild){\n                onLoad(null); //avoid errors on the optimizer\n            }else{\n                var id = uid();\n                //create a global variable that stores onLoad so callback\n                //function can define new module after async load\n                window[id] = onLoad;\n                injectScript(formatUrl(req.toUrl(name), id));\n            }\n        }\n    };\n});\n\n","define('mapsetup',['gmaps'], function mapsetup(gmaps) {\n  'use strict';\n\n  var mapOptions = {\n      center: { lat: 36.771, lng: -104.482}, // The whittington center\n      mapTypeId: gmaps.MapTypeId.TERRAIN,\n      zoom: 8\n    };\n\n  return new gmaps.Map(document.getElementById('map-canvas'), mapOptions);\n\n\n});\n\n","/**\n * @name StyledMarkerMaker\n * @version 0.5\n * @author Gabriel Schneider\n * @copyright (c) 2010 Gabriel Schneider\n * @fileoverview This gives you static functions for creating dynamically\n *     styled markers using Charts API outputs as well as an ability to\n *     extend with custom types.\n */\n\n/**\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\ndefine('smarker',['gmaps'], function mapsetup(gmaps) {\n\n  var StyledIconTypes = {};\n  var StyledMarker, StyledIcon;\n\n  /**\n   * @param {Function} childCtor Child class.\n   * @param {Function} parentCtor Parent class.\n   */\n  function inherits(childCtor, parentCtor) {\n    /** @constructor */\n    function tempCtor() {};\n    tempCtor.prototype = parentCtor.prototype;\n    childCtor.superClass_ = parentCtor.prototype;\n    childCtor.prototype = new tempCtor();\n    /** @override */\n    childCtor.prototype.constructor = childCtor;\n  }\n\n  (function() {\n    var bu_ = 'https://chart.googleapis.com/chart?chst=';\n    var gm_ = gmaps;\n    var gp_ = gm_.Point;\n    var ge_ = gm_.event;\n    var gmi_ = gm_.MarkerImage;\n\n\n    /**\n    * This class is an extended version of google.maps.Marker. It allows\n    * styles to be applied that change it's appearance.\n    * @extends google.maps.Marker\n    * @param {StyledMarkerOptions} StyledMarkerOptions The options for the Marker\n    */\n    StyledMarker = function(styledMarkerOptions) {\n      gm_.Marker.call(this);\n      var me=this;\n      var ci = me.styleIcon = styledMarkerOptions.styleIcon;\n      me.bindTo('icon',ci);\n      me.bindTo('shadow',ci);\n      me.bindTo('shape',ci);\n      me.setOptions(styledMarkerOptions);\n    };\n    inherits(StyledMarker, gm_.Marker);\n\n    /**\n    * This class stores style information that can be applied to StyledMarkers.\n    * @extends google.maps.MVCObject\n    * @param {StyledIconType} styledIconType The type of style this icon is.\n    * @param {StyledIconOptions} styledIconOptions The options for this StyledIcon.\n    * @param {StyledIcon} styleClass A class to apply extended style information.\n    */\n    StyledIcon = function(styledIconType,styledIconOptions,styleClass) {\n      var k;\n      var me=this;\n      var i_ = 'icon';\n      var sw_ = 'shadow';\n      var s_ = 'shape';\n      var a_ = [];\n\n      function gs_() {\n        var image_ = document.createElement('img');\n        var simage_ = document.createElement('img');\n        ge_.addDomListenerOnce(simage_, 'load', function() {\n          var w = simage_.width, h = simage_.height;\n          me.set(sw_,new gmi_(styledIconType.getShadowURL(me),null,null,styledIconType.getShadowAnchor(me,w,h)));\n          simage = null;\n        });\n        ge_.addDomListenerOnce(image_, 'load', function() {\n          var w = image_.width, h = image_.height;\n          me.set(i_,new gmi_(styledIconType.getURL(me),null,null,styledIconType.getAnchor(me,w,h)));\n          me.set(s_,styledIconType.getShape(me,w,h));\n          image_ = null;\n        });\n        image_.src = styledIconType.getURL(me);\n        simage_.src = styledIconType.getShadowURL(me);\n      }\n\n      /**\n      * set:\n      * This function sets a given style property to the given value.\n      * @param {String} name The name of the property to set.\n      * @param {Object} value The value to set the property to.\n      * get:\n      * This function gets a given style property.\n      * @param {String} name The name of the property to get.\n      * @return {Object}\n      */\n      me.as_ = function(v) {\n        a_.push(v);\n        for(k in styledIconOptions) {\n          v.set(k, styledIconOptions[k]);\n        }\n      }\n\n      if (styledIconType !== StyledIconTypes.CLASS) {\n        for (k in styledIconType.defaults) {\n          me.set(k, styledIconType.defaults[k]);\n        }\n        me.setValues(styledIconOptions);\n        me.set(i_,styledIconType.getURL(me));\n        me.set(sw_,styledIconType.getShadowURL(me));\n        if (styleClass) styleClass.as_(me);\n        gs_();\n        me.changed = function(k) {\n          if (k!==i_&&k!==s_&&k!==sw_) {\n            gs_();\n          }\n        };\n      } else {\n        me.setValues(styledIconOptions);\n        me.changed = function(v) {\n          styledIconOptions[v] = me.get(v);\n          for (k = 0; k < a_.length; k++) {\n            a_[k].set(v,me.get(v));\n          }\n        };\n        if (styleClass) styleClass.as_(me);\n      }\n    };\n    StyledIcon.prototype = new gm_.MVCObject();\n\n    /**\n    * StyledIconType\n    * This class holds functions for building the information needed to style markers.\n    * getURL:\n    * This function builds and returns a URL to use for the Marker icon property.\n    * @param {StyledIcon} icon The StyledIcon that holds style information\n    * @return {String}\n    * getShadowURL:\n    * This function builds and returns a URL to use for the Marker shadow property.\n    * @param {StyledIcon} icon The StyledIcon that holds style information\n    * @return {String{\n    * getAnchor:\n    * This function builds and returns a Point to indicate where the marker is placed.\n    * @param {StyledIcon} icon The StyledIcon that holds style information\n    * @param {Number} width The width of the icon image.\n    * @param {Number} height The height of the icon image.\n    * @return {google.maps.Point}\n    * getShadowAnchor:\n    * This function builds and returns a Point to indicate where the shadow is placed.\n    * @param {StyledIcon} icon The StyledIcon that holds style information\n    * @param {Number} width The width of the shadow image.\n    * @param {Number} height The height of the shadow image.\n    * @return {google.maps.Point}\n    * getShape:\n    * This function builds and returns a MarkerShape to indicate where the Marker is clickable.\n    * @param {StyledIcon} icon The StyledIcon that holds style information\n    * @param {Number} width The width of the icon image.\n    * @param {Number} height The height of the icon image.\n    * @return {google.maps.MarkerShape}\n    */\n\n    StyledIconTypes.CLASS = {};\n\n    StyledIconTypes.MARKER = {\n      defaults: {\n        text:'',\n        color:'00ff00',\n        fore:'000000',\n        starcolor:null\n      },\n      getURL: function(props){\n        var _url;\n        var starcolor_=props.get('starcolor');\n        var text_=props.get('text');\n        var color_=props.get('color').replace(/#/,'');\n        var fore_=props.get('fore').replace(/#/,'');\n        if (starcolor_) {\n          _url = bu_ + 'd_map_xpin_letter&chld=pin_star|';\n        } else {\n          _url = bu_ + 'd_map_pin_letter&chld=';\n        }\n        if (text_) {\n          text_ = text_.substr(0,2);\n        }\n        _url+=text_+'|';\n        _url+=color_+'|';\n        _url+=fore_;\n        if (starcolor_) {\n          _url+='|'+starcolor_.replace(/#/,'');\n        }\n        return _url;\n      },\n      getShadowURL: function(props){\n        if (props.get('starcolor')) {\n          return bu_ + 'd_map_xpin_shadow&chld=pin_star';\n        } else {\n          return bu_ + 'd_map_pin_shadow';\n        }\n      },\n      getAnchor: function(props,width,height){\n        return new gp_(width / 2,height);\n      },\n      getShadowAnchor: function(props,width,height){\n        return new gp_(width / 4,height);\n      },\n      getShape: function(props,width,height){\n        var _iconmap = {};\n        _iconmap.coord = [\n          width / 2, height,\n          (7 / 16) * width, (5 / 8) * height,\n          (5 / 16) * width, (7 / 16) * height,\n          (7 / 32) * width, (5 / 16) * height,\n          (5 / 16) * width, (1 / 8) * height,\n          (1 / 2) * width, 0,\n          (11 / 16) * width, (1 / 8) * height,\n          (25 / 32) * width, (5 / 16) * height,\n          (11 / 16) * width, (7 / 16) * height,\n          (9 / 16) * width, (5 / 8) * height\n        ];\n        for (var i = 0; i < _iconmap.coord.length; i++) {\n          _iconmap.coord[i] = Math.round(_iconmap.coord[i]);\n        }\n        _iconmap.type = 'poly';\n        return _iconmap;\n      }\n    };\n    StyledIconTypes.BUBBLE = {\n      defaults: {\n        text:'',\n        color:'00ff00',\n        fore:'000000'\n      },\n      getURL: function(props){\n        var _url = bu_ + 'd_bubble_text_small&chld=bb|';\n        _url+=props.get('text')+'|';\n        _url+=props.get('color').replace(/#/,'')+'|';\n        _url+=props.get('fore').replace(/#/,'');\n        return _url;\n      },\n      getShadowURL: function(props){\n        return bu_ + 'd_bubble_text_small_shadow&chld=bb|' + props.get('text');\n      },\n      getAnchor: function(props,width,height){\n        return new google.maps.Point(0,42);\n      },\n      getShadowAnchor: function(props,width,height){\n        return new google.maps.Point(0,44);\n      },\n      getShape: function(props,width,height){\n        var _iconmap = {};\n        _iconmap.coord = [\n          0,44,\n          13,26,\n          13,6,\n          17,1,\n          width - 4,1,\n          width,6,\n          width,21,\n          width - 4,26,\n          21,26\n        ];\n        _iconmap.type = 'poly';\n        return _iconmap;\n      }\n    };\n  })();\n  return {\n    StyledMarker: StyledMarker,\n    StyledIcon: StyledIcon,\n    StyledIconTypes: StyledIconTypes\n  };\n});\n\n","define('utils',['jquery', 'lodash', 'gmaps', 'mapsetup', 'smarker'], function mapsetup($, _, gmaps, map, sm) {\n  'use strict';\n\n  var utils, templates, ev = $('#map-canvas').data('event');\n\n  _.templateSettings.variable = 'data';\n\n  templates = {\n    racerInfoBox: _.template(['<div class=\"info-box\"><span class=\"info-points\"><%= data.name %></span>',\n                         '<span class=\"info-points\"><a href=\"<%= data.bio %>\"><%= data.nickname %></a></span></div>'].join('')),\n    eventInfoBox: _.template(['<div class=\"info-box\"><span class=\"info-points\"><%= data.name %></span>',\n                         '<span class=\"info-points\"><%= data.description %></span></div>'].join(''))\n  };\n\n  utils = {\n    getObjects: function getObjects(url) {\n      return $.getJSON(url, {'event': ev});\n    },\n    fixDates: function fixDates(obj) {\n      // This is a mutable mess, welcome to javascript\n      obj.timestamp = new Date(obj.timestamp);\n    },\n    logger: function logger(msg, _type) {\n      var type = _type || 'error';\n      console[type](msg);\n    },\n    addLatLon: function addLatLon(obj) {\n      obj.latLng = new gmaps.LatLng(obj.latitude, obj.longitude);\n    },\n    createRacerPoint: function createRacerPoint(obj) {\n      var si = new sm.StyledIcon(sm.StyledIconTypes.BUBBLE, {color: obj.color, text: obj.nickname});\n      obj.marker = new sm.StyledMarker({\n        styleIcon: si,\n        position: obj.latLng,\n        map: map,\n        title: obj.nickname\n      });\n      // The info box only needs to be created once per user\n      obj.infowindow = new gmaps.InfoWindow({\n        content: templates.racerInfoBox(obj)\n      });\n\n      gmaps.event.addListener(obj.marker, 'click', function cl() {\n        obj.infowindow.open(map, obj.marker);\n      });\n    },\n    createEventPoint: function createEventPoint(obj) {\n      utils.addLatLon(obj);\n      var si = new sm.StyledIcon(sm.StyledIconTypes.BUBBLE, {color: '#FCC200', text: obj.name});\n      obj.marker = new sm.StyledMarker({\n        styleIcon: si,\n        position: obj.latLng,\n        map: map,\n        title: obj.name\n      });\n      // The info box only needs to be created once per user\n      obj.infowindow = new gmaps.InfoWindow({\n        content: templates.eventInfoBox(obj)\n      });\n\n      gmaps.event.addListener(obj.marker, 'click', function cl() {\n        obj.infowindow.open(map, obj.marker);\n      });\n    },\n    drawTrack: function drawTrack(obj) {\n      // polyline draws points, marker shows checkins\n      var track = new gmaps.Polyline({\n        path: _.map(obj, function (o) { return o.latLng; }),\n        geodesic: true,\n        strokeColor: obj[0].color,\n        strokeOpacity: 1.0,\n        strokeWeight: 2\n      });\n      track.setMap(map);\n      obj.track = track;\n    }\n  };\n\n  return utils;\n\n});\n\n","define('addracers',['lodash', 'utils'], function addracers(_, utils) {\n  'use strict';\n\n  var api, internal;\n\n  internal = {\n    markers: [],\n    cleanMarkers: function cleanMarkers(xs) {\n      _.forEach(internal.markers, function (o) {\n        o.setMap(null);\n      });\n      internal.markers = xs;\n    }\n  };\n\n  api = {\n    parseResponse: function parseResponse(obj) {\n      var i, l, key, inObj, newest, markers = [],\n          comp = _.groupBy(obj.competitors, function (o) { return o.spotId; });\n      for (key in comp) {\n        if (comp.hasOwnProperty(key)) {\n          newest = null;\n          for (i = 0, l = comp[key].length;  i < l; i += 1) {\n            inObj = comp[key][i];\n            utils.fixDates(inObj);\n            utils.addLatLon(inObj);\n            if (newest === null || inObj.timestamp > newest.timestamp) {\n              newest = inObj;\n            }\n          }\n          //utils.drawTrack(comp[key]);\n        }\n        utils.createRacerPoint(newest);\n        markers.push(newest.marker);\n      }\n      internal.cleanMarkers(markers);\n\n      // Export for debugging\n      window.competitors = comp;\n      internal.compStore = comp;\n    },\n    poll: function poll() {\n      utils.logger('polling', 'info');\n      utils.getObjects('/location').then(api.parseResponse, utils.logger);\n    }\n  };\n\n  function init() {\n    utils.getObjects('/location').then(api.parseResponse, utils.logger);\n    internal.__poll = setInterval(api.poll, 300000);\n    window.__DEBUG_RACERS__ = {internal: internal, api: api};\n  }\n\n  return {init: init};\n\n});\n\n","define('addevents',['utils'], function addracers(utils) {\n  'use strict';\n\n  var api, internal;\n\n  internal = {};\n\n  api = {\n    parseResponse: function parseResponse(obj) {\n      var i, l;\n\n      for (i = 0, l = obj.race_points.length; i < l; i += 1) {\n        utils.createEventPoint(obj.race_points[i]);\n      }\n\n      // Export for debugging\n      window.obstacles = obj.race_points;\n      internal.obstacles = obj.race_points;\n    }\n  };\n\n  function init() {\n    utils.getObjects('/racepoints').then(api.parseResponse, utils.logger);\n    window.__DEBUG_EVENTS__ = {internal: internal, api: api};\n  }\n\n  return {init: init};\n});\n\n","define('sidebar',['react', 'jquery'], function sidebar(React, $) {\n  'use strict';\n\n  var internal = {\n    cache: {\n      sideUl: document.getElementById('competitorList'),\n      ev: $('#map-canvas').data('event')\n    },\n    compCb: function compCb (resp) {\n      if (this.isMounted()) {\n        this.setState({\n          competitors: resp.competitors\n        });\n      }\n    }\n  };\n\n  var Competitor = React.createClass({displayName: \"Competitor\",\n    mixins: [React.addons.PureRenderMixin],\n    render: function () {\n      //console.log(this.props);\n      return (React.createElement(\"li\", null, \n               React.createElement(\"div\", {className: \"competitor\"}, \n                  React.createElement(\"span\", {className: \"comp-info\", style: {color: this.props.data.color}}, this.props.data.name), \n                  React.createElement(\"span\", {className: \"comp-info\"}, React.createElement(\"a\", {href: this.props.data.bio}, this.props.data.nickname))\n               )\n             ));\n    }\n  });\n\n  var CompetitorList = React.createClass({displayName: \"CompetitorList\",\n    getInitialState: function () {\n      return {\n        competitors: []\n      };\n    },\n    componentDidMount: function () {\n      $.getJSON(this.props.source, {'event': internal.cache.ev}, internal.compCb.bind(this));\n    },\n    render: function () {\n      //console.log(this.props);\n      // This matches the docs, not sure why react still warns abt key\n      var rows = this.state.competitors.map(function cfe(comp) {\n        return React.createElement(Competitor, {data: comp, key: comp.spotId});\n      }.bind(this));\n      return (React.createElement(\"ul\", null, rows));\n    }\n  });\n\n  function init () {\n    React.render(React.createElement(CompetitorList, {source: \"/competitors\"}), internal.cache.sideUl);\n  }\n\n  return {load: init};\n\n});\n\n"]}